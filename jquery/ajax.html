<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FETCHING DATA TO TABEL USING AJEX</title>
    <style>
      table {
        width: 100%;
      }
      th {
        background: yellow;
        font-weight: bold;
        padding: 6px;
      }
      td {
        background: gray;
        padding: 6px;
      }
    </style>
  </head>

  <body>
    <h2>ADD TITLE AND CONTENT IN TO THE BODY</h2>

    <form id="form" method="post">
      <label>TITLE:</label><br />
      <input type="text" name="title" id="title" placeholder="ADD TITLE" />
      <br />
      <label>BODY:</label><br />
      <input type="text" name="body" id="body" placeholder="ADD YOUR CONTENT" />
      <br />

      <input type="submit" value="Submit" />
    </form>

    <table id="myTable">
      <tr>
        <!-- <th>User id</th>
        <th>ID</th> -->
        <th>TITLE</th>
        <th>BODY</th>
        <th>delete</th>
      </tr>
    </table>

    <script>
      $(document).ready(function () {
        $.get("https://jsonplaceholder.typicode.com/posts", function (data) {
          let olddata = "";
          $.each(data, function (key, value) {
            olddata += "<tr>";
            olddata += "<td>" + value.title + "</td>";
            olddata += "<td>" + value.body + "</td>";
            olddata +=
              "<td>" +
              `<button type='button' class= 'delete' id='${value.id}'>delete!</button>` +
              "</td>";

            olddata += "</tr>";
          });
          $("#myTable").append(olddata);
        });

        $("#form").submit(function (e) {
          e.preventDefault();
          let data = {
            title: $("#title").val(),
            body: $("#body").val(),
          };
          //   let str = $("#form").serialize();
          $.ajax({
            url: "https://jsonplaceholder.typicode.com/posts",
            type: "POST",
            data: data,
            success: function (response) {
              let newdata = "";
              newdata += "<tr>";
              newdata += "<td>" + response.title + "</td>";
              newdata += "<td>" + response.body + "</td>";
              newdata +=
                "<td>" +
                "<button type='button' class = 'delete'>delete!</button>" +
                "</td>";
              newdata += "</tr>";
              $("table").append(newdata);
            },
          });
          $("#form").trigger("reset");
        });
      });
      $(document).on("click", ".delete", function () {
        let dal = $(this).attr("id");
        let newDal = $(this).closest("tr");
        $.ajax({
          url: `https://jsonplaceholder.typicode.com/posts/${dal}`,
          type: "DELETE",
          success: function () {
            newDal.remove();
          },
        });
      });
    </script>
  </body>
</html>
